Loading python/3.9.12/gcc/pdcqf4o5
  Loading requirement: libmd/1.0.4/gcc/cb4tpaqj libbsd/0.11.5/gcc/xsr6mhaa
    expat/2.4.8/gcc/xuqakzcy ncurses/6.2/gcc/qke6jyyt readline/8.1/gcc/bgw44yb2
    gdbm/1.23/gcc/dviudcmk libiconv/1.16/gcc/aa2kwjch
    libxml2/2.9.13/gcc/fww2yzpt gettext/0.21/gcc/lhdl4tbr
    libffi/3.4.2/gcc/alfpockh sqlite/3.38.5/gcc/xdyquaax tcl/8.6.12/gcc/gf3ofu4d
    inputproto/2.3.2/gcc/bwj4rzah kbproto/1.0.7/gcc/go5c2zyv
    libpthread-stubs/0.4/gcc/zyf6irr6 xproto/7.0.31/gcc/f5csjg7w
    libxau/1.0.8/gcc/dfmabka4 libxdmcp/1.1.2/gcc/iilv5r4i
    xcb-proto/1.14.1/gcc/ppnp4lo4 libxcb/1.14/gcc/cmzk7sor
    xextproto/7.3.0/gcc/oowjkbwu xtrans/1.3.5/gcc/zrqo6ghr
    libx11/1.7.0/gcc/pe2khlxx font-util/1.3.2/gcc/d376rdkf
    libpng/1.6.37/gcc/trvruff6 freetype/2.11.1/gcc/u4bjufog
    util-linux-uuid/2.37.4/gcc/h7hztrtm fontconfig/2.13.1/gcc/ya6ibpmq
    renderproto/0.11.1/gcc/b2jkdp6e libxrender/0.9.10/gcc/n6yxi44d
    libxft/2.3.2/gcc/zay6bixf libxext/1.3.3/gcc/p7y37pfb
    scrnsaverproto/1.2.2/gcc/fzbihsla libxscrnsaver/1.2.2/gcc/t5hd2qnu
    tk/8.6.11/gcc/vdahj5in
running __run_main.py__ ...
HyParams-Retrieved
Found directories: ['dust_maps', 'params', 'cmb_maps', 'mixed_maps']
Warning: Could not load or process parameter file. Error: 'utf-8' codec can't decode byte 0x93 in position 0: invalid start byte

--- Final Shapes ---
CMB shape: (1000, 64, 64)
Dust shape: (1000, 64, 64)
Mixed shape: (1000, 64, 64)
Dataset-Retrieved
(800, 1, 64, 64) (200, 1, 64, 64)
started-training cosmo ...
(2, 1, 64, 64) (2,)
- UNET-summary -
____________________________________________________________________________________________________
Model: Unet1D
====================================================================================================
Layer (type)                            Output Shape             Param #        
====================================================================================================
input_1 (InputLayer)                    (2, 1, 64, 64)           0              
input_2 (InputLayer)                    (2,)                     0              
init_conv.proj (Conv2d)                 (2, 32, 64, 64)          320            
init_conv.norm (GroupNorm)              (2, 32, 64, 64)          64             
init_conv.act (SiLU)                    (2, 32, 64, 64)          0              
init_conv.dropout (Dropout2d)           (2, 32, 64, 64)          0              
down_blocks.0.block1.proj (Conv2d)      (2, 64, 64, 64)          18496          
down_blocks.0.block1.norm (GroupNorm)   (2, 64, 64, 64)          128            
down_blocks.0.block1.act (SiLU)         (2, 64, 64, 64)          0              
down_blocks.0.block1.dropout (Dropout2d)(2, 64, 64, 64)          0              
down_blocks.0.block1 (BlockGDiff2D)     (2, 64, 64, 64)          18624          
down_blocks.0.block2.proj (Conv2d)      (2, 64, 64, 64)          36928          
down_blocks.0.block2.norm (GroupNorm)   (2, 64, 64, 64)          128            
down_blocks.0.block2.act (SiLU)         (2, 64, 64, 64)          0              
down_blocks.0.block2.dropout (Dropout2d)(2, 64, 64, 64)          0              
down_blocks.0.block2 (BlockGDiff2D)     (2, 64, 64, 64)          37056          
down_blocks.0.res_conv (Conv2d)         (2, 64, 64, 64)          2112           
down_blocks.0 (ResnetBlockGDiff2D)      (2, 64, 64, 64)          57792          
time_embeddings.0 (SinusoidalTimeEmbedding)(2, 64)                  0              
alpha_embeddings.0.embedding_layer.0 (Linear)(2, 32)                  96             
alpha_embeddings.0.embedding_layer.1 (SiLU)(2, 32)                  0              
alpha_embeddings.0.embedding_layer.2 (Linear)(2, 32)                  1056           
alpha_embeddings.0.embedding_layer.3 (SiLU)(2, 32)                  0              
alpha_embeddings.0.embedding_layer.4 (Linear)(2, 64)                  2112           
alpha_embeddings.0.embedding_layer (Sequential)(2, 64)                  3264           
alpha_embeddings.0 (PhiEmbeddingCosmo)  (2, 64)                  3264           
down_blocks.1.block1.proj (Conv2d)      (2, 128, 64, 64)         73856          
down_blocks.1.block1.norm (GroupNorm)   (2, 128, 64, 64)         256            
down_blocks.1.block1.act (SiLU)         (2, 128, 64, 64)         0              
down_blocks.1.block1.dropout (Dropout2d)(2, 128, 64, 64)         0              
down_blocks.1.block1 (BlockGDiff2D)     (2, 128, 64, 64)         74112          
down_blocks.1.block2.proj (Conv2d)      (2, 128, 64, 64)         147584         
down_blocks.1.block2.norm (GroupNorm)   (2, 128, 64, 64)         256            
down_blocks.1.block2.act (SiLU)         (2, 128, 64, 64)         0              
down_blocks.1.block2.dropout (Dropout2d)(2, 128, 64, 64)         0              
down_blocks.1.block2 (BlockGDiff2D)     (2, 128, 64, 64)         147840         
down_blocks.1.res_conv (Conv2d)         (2, 128, 64, 64)         8320           
down_blocks.1 (ResnetBlockGDiff2D)      (2, 128, 64, 64)         230272         
time_embeddings.1 (SinusoidalTimeEmbedding)(2, 128)                 0              
alpha_embeddings.1.embedding_layer.0 (Linear)(2, 32)                  96             
alpha_embeddings.1.embedding_layer.1 (SiLU)(2, 32)                  0              
alpha_embeddings.1.embedding_layer.2 (Linear)(2, 32)                  1056           
alpha_embeddings.1.embedding_layer.3 (SiLU)(2, 32)                  0              
alpha_embeddings.1.embedding_layer.4 (Linear)(2, 128)                 4224           
alpha_embeddings.1.embedding_layer (Sequential)(2, 128)                 5376           
alpha_embeddings.1 (PhiEmbeddingCosmo)  (2, 128)                 5376           
down_blocks.2.block1.proj (Conv2d)      (2, 256, 64, 64)         295168         
down_blocks.2.block1.norm (GroupNorm)   (2, 256, 64, 64)         512            
down_blocks.2.block1.act (SiLU)         (2, 256, 64, 64)         0              
down_blocks.2.block1.dropout (Dropout2d)(2, 256, 64, 64)         0              
down_blocks.2.block1 (BlockGDiff2D)     (2, 256, 64, 64)         295680         
down_blocks.2.block2.proj (Conv2d)      (2, 256, 64, 64)         590080         
down_blocks.2.block2.norm (GroupNorm)   (2, 256, 64, 64)         512            
down_blocks.2.block2.act (SiLU)         (2, 256, 64, 64)         0              
down_blocks.2.block2.dropout (Dropout2d)(2, 256, 64, 64)         0              
down_blocks.2.block2 (BlockGDiff2D)     (2, 256, 64, 64)         590592         
down_blocks.2.res_conv (Conv2d)         (2, 256, 64, 64)         33024          
down_blocks.2 (ResnetBlockGDiff2D)      (2, 256, 64, 64)         919296         
time_embeddings.2 (SinusoidalTimeEmbedding)(2, 256)                 0              
alpha_embeddings.2.embedding_layer.0 (Linear)(2, 32)                  96             
alpha_embeddings.2.embedding_layer.1 (SiLU)(2, 32)                  0              
alpha_embeddings.2.embedding_layer.2 (Linear)(2, 32)                  1056           
alpha_embeddings.2.embedding_layer.3 (SiLU)(2, 32)                  0              
alpha_embeddings.2.embedding_layer.4 (Linear)(2, 256)                 8448           
alpha_embeddings.2.embedding_layer (Sequential)(2, 256)                 9600           
alpha_embeddings.2 (PhiEmbeddingCosmo)  (2, 256)                 9600           
attn_blocks.2.to_qkv (Conv2d)           (2, 384, 64, 64)         98304          
attn_blocks.2.to_out (Conv2d)           (2, 256, 64, 64)         33024          
attn_blocks.2 (SelfAttention2D)         (2, 256, 64, 64)         131328         
down_blocks.3.block1.proj (Conv2d)      (2, 512, 64, 64)         1180160        
down_blocks.3.block1.norm (GroupNorm)   (2, 512, 64, 64)         1024           
down_blocks.3.block1.act (SiLU)         (2, 512, 64, 64)         0              
down_blocks.3.block1.dropout (Dropout2d)(2, 512, 64, 64)         0              
down_blocks.3.block1 (BlockGDiff2D)     (2, 512, 64, 64)         1181184        
down_blocks.3.block2.proj (Conv2d)      (2, 512, 64, 64)         2359808        
down_blocks.3.block2.norm (GroupNorm)   (2, 512, 64, 64)         1024           
down_blocks.3.block2.act (SiLU)         (2, 512, 64, 64)         0              
down_blocks.3.block2.dropout (Dropout2d)(2, 512, 64, 64)         0              
down_blocks.3.block2 (BlockGDiff2D)     (2, 512, 64, 64)         2360832        
down_blocks.3.res_conv (Conv2d)         (2, 512, 64, 64)         131584         
down_blocks.3 (ResnetBlockGDiff2D)      (2, 512, 64, 64)         3673600        
time_embeddings.3 (SinusoidalTimeEmbedding)(2, 512)                 0              
alpha_embeddings.3.embedding_layer.0 (Linear)(2, 32)                  96             
alpha_embeddings.3.embedding_layer.1 (SiLU)(2, 32)                  0              
alpha_embeddings.3.embedding_layer.2 (Linear)(2, 32)                  1056           
alpha_embeddings.3.embedding_layer.3 (SiLU)(2, 32)                  0              
alpha_embeddings.3.embedding_layer.4 (Linear)(2, 512)                 16896          
alpha_embeddings.3.embedding_layer (Sequential)(2, 512)                 18048          
alpha_embeddings.3 (PhiEmbeddingCosmo)  (2, 512)                 18048          
attn_blocks.3.to_qkv (Conv2d)           (2, 384, 64, 64)         196608         
attn_blocks.3.to_out (Conv2d)           (2, 512, 64, 64)         66048          
attn_blocks.3 (SelfAttention2D)         (2, 512, 64, 64)         262656         
bottleneck.proj (Conv2d)                (2, 512, 64, 64)         2359808        
bottleneck.norm (GroupNorm)             (2, 512, 64, 64)         1024           
bottleneck.act (SiLU)                   (2, 512, 64, 64)         0              
bottleneck.dropout (Dropout2d)          (2, 512, 64, 64)         0              
time_embeddings.3 (SinusoidalTimeEmbedding)(2, 512)                 0              
att_bottleneck.to_qkv (Conv2d)          (2, 384, 64, 64)         196608         
att_bottleneck.to_out (Conv2d)          (2, 512, 64, 64)         66048          
bottl_down.proj (Conv2d)                (2, 256, 64, 64)         1179904        
bottl_down.norm (GroupNorm)             (2, 256, 64, 64)         512            
bottl_down.act (SiLU)                   (2, 256, 64, 64)         0              
bottl_down.dropout (Dropout2d)          (2, 256, 64, 64)         0              
up_blocks.0.block1.proj (Conv2d)        (2, 256, 64, 64)         1769728        
up_blocks.0.block1.norm (GroupNorm)     (2, 256, 64, 64)         512            
up_blocks.0.block1.act (SiLU)           (2, 256, 64, 64)         0              
up_blocks.0.block1.dropout (Dropout2d)  (2, 256, 64, 64)         0              
up_blocks.0.block1 (BlockGDiff2D)       (2, 256, 64, 64)         1770240        
up_blocks.0.block2.proj (Conv2d)        (2, 256, 64, 64)         590080         
up_blocks.0.block2.norm (GroupNorm)     (2, 256, 64, 64)         512            
up_blocks.0.block2.act (SiLU)           (2, 256, 64, 64)         0              
up_blocks.0.block2.dropout (Dropout2d)  (2, 256, 64, 64)         0              
up_blocks.0.block2 (BlockGDiff2D)       (2, 256, 64, 64)         590592         
up_blocks.0.res_conv (Conv2d)           (2, 256, 64, 64)         196864         
up_blocks.0 (ResnetBlockGDiff2D)        (2, 256, 64, 64)         2557696        
time_embeddings_up.0 (SinusoidalTimeEmbedding)(2, 256)                 0              
alpha_embeddings_up.0.embedding_layer.0 (Linear)(2, 32)                  96             
alpha_embeddings_up.0.embedding_layer.1 (SiLU)(2, 32)                  0              
alpha_embeddings_up.0.embedding_layer.2 (Linear)(2, 32)                  1056           
alpha_embeddings_up.0.embedding_layer.3 (SiLU)(2, 32)                  0              
alpha_embeddings_up.0.embedding_layer.4 (Linear)(2, 256)                 8448           
alpha_embeddings_up.0.embedding_layer (Sequential)(2, 256)                 9600           
alpha_embeddings_up.0 (PhiEmbeddingCosmo)(2, 256)                 9600           
up_blocks.1.block1.proj (Conv2d)        (2, 128, 64, 64)         589952         
up_blocks.1.block1.norm (GroupNorm)     (2, 128, 64, 64)         256            
up_blocks.1.block1.act (SiLU)           (2, 128, 64, 64)         0              
up_blocks.1.block1.dropout (Dropout2d)  (2, 128, 64, 64)         0              
up_blocks.1.block1 (BlockGDiff2D)       (2, 128, 64, 64)         590208         
up_blocks.1.block2.proj (Conv2d)        (2, 128, 64, 64)         147584         
up_blocks.1.block2.norm (GroupNorm)     (2, 128, 64, 64)         256            
up_blocks.1.block2.act (SiLU)           (2, 128, 64, 64)         0              
up_blocks.1.block2.dropout (Dropout2d)  (2, 128, 64, 64)         0              
up_blocks.1.block2 (BlockGDiff2D)       (2, 128, 64, 64)         147840         
up_blocks.1.res_conv (Conv2d)           (2, 128, 64, 64)         65664          
up_blocks.1 (ResnetBlockGDiff2D)        (2, 128, 64, 64)         803712         
time_embeddings_up.1 (SinusoidalTimeEmbedding)(2, 128)                 0              
alpha_embeddings_up.1.embedding_layer.0 (Linear)(2, 32)                  96             
alpha_embeddings_up.1.embedding_layer.1 (SiLU)(2, 32)                  0              
alpha_embeddings_up.1.embedding_layer.2 (Linear)(2, 32)                  1056           
alpha_embeddings_up.1.embedding_layer.3 (SiLU)(2, 32)                  0              
alpha_embeddings_up.1.embedding_layer.4 (Linear)(2, 128)                 4224           
alpha_embeddings_up.1.embedding_layer (Sequential)(2, 128)                 5376           
alpha_embeddings_up.1 (PhiEmbeddingCosmo)(2, 128)                 5376           
up_blocks.2.block1.proj (Conv2d)        (2, 64, 64, 64)          147520         
up_blocks.2.block1.norm (GroupNorm)     (2, 64, 64, 64)          128            
up_blocks.2.block1.act (SiLU)           (2, 64, 64, 64)          0              
up_blocks.2.block1.dropout (Dropout2d)  (2, 64, 64, 64)          0              
up_blocks.2.block1 (BlockGDiff2D)       (2, 64, 64, 64)          147648         
up_blocks.2.block2.proj (Conv2d)        (2, 64, 64, 64)          36928          
up_blocks.2.block2.norm (GroupNorm)     (2, 64, 64, 64)          128            
up_blocks.2.block2.act (SiLU)           (2, 64, 64, 64)          0              
up_blocks.2.block2.dropout (Dropout2d)  (2, 64, 64, 64)          0              
up_blocks.2.block2 (BlockGDiff2D)       (2, 64, 64, 64)          37056          
up_blocks.2.res_conv (Conv2d)           (2, 64, 64, 64)          16448          
up_blocks.2 (ResnetBlockGDiff2D)        (2, 64, 64, 64)          201152         
time_embeddings_up.2 (SinusoidalTimeEmbedding)(2, 64)                  0              
alpha_embeddings_up.2.embedding_layer.0 (Linear)(2, 32)                  96             
alpha_embeddings_up.2.embedding_layer.1 (SiLU)(2, 32)                  0              
alpha_embeddings_up.2.embedding_layer.2 (Linear)(2, 32)                  1056           
alpha_embeddings_up.2.embedding_layer.3 (SiLU)(2, 32)                  0              
alpha_embeddings_up.2.embedding_layer.4 (Linear)(2, 64)                  2112           
alpha_embeddings_up.2.embedding_layer (Sequential)(2, 64)                  3264           
alpha_embeddings_up.2 (PhiEmbeddingCosmo)(2, 64)                  3264           
up_blocks.3.block1.proj (Conv2d)        (2, 32, 64, 64)          36896          
up_blocks.3.block1.norm (GroupNorm)     (2, 32, 64, 64)          64             
up_blocks.3.block1.act (SiLU)           (2, 32, 64, 64)          0              
up_blocks.3.block1.dropout (Dropout2d)  (2, 32, 64, 64)          0              
up_blocks.3.block1 (BlockGDiff2D)       (2, 32, 64, 64)          36960          
up_blocks.3.block2.proj (Conv2d)        (2, 32, 64, 64)          9248           
up_blocks.3.block2.norm (GroupNorm)     (2, 32, 64, 64)          64             
up_blocks.3.block2.act (SiLU)           (2, 32, 64, 64)          0              
up_blocks.3.block2.dropout (Dropout2d)  (2, 32, 64, 64)          0              
up_blocks.3.block2 (BlockGDiff2D)       (2, 32, 64, 64)          9312           
up_blocks.3.res_conv (Conv2d)           (2, 32, 64, 64)          4128           
up_blocks.3 (ResnetBlockGDiff2D)        (2, 32, 64, 64)          50400          
time_embeddings_up.3 (SinusoidalTimeEmbedding)(2, 32)                  0              
alpha_embeddings_up.3.embedding_layer.0 (Linear)(2, 32)                  96             
alpha_embeddings_up.3.embedding_layer.1 (SiLU)(2, 32)                  0              
alpha_embeddings_up.3.embedding_layer.2 (Linear)(2, 32)                  1056           
alpha_embeddings_up.3.embedding_layer.3 (SiLU)(2, 32)                  0              
alpha_embeddings_up.3.embedding_layer.4 (Linear)(2, 32)                  1056           
alpha_embeddings_up.3.embedding_layer (Sequential)(2, 32)                  2208           
alpha_embeddings_up.3 (PhiEmbeddingCosmo)(2, 32)                  2208           
outc.conv (Conv2d)                      (2, 1, 64, 64)           33             
====================================================================================================
Total params: 12,748,961
Trainable params: 12,748,961
Non-trainable params: 0
____________________________________________________________________________________________________
Validation-Stepper:  25
